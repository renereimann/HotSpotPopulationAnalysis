from scipy.interpolate import UnivariateSpline

def spline_data(data):
    nsources = []
    flux = []
    for l in data.split("\n"):
        nsources.append(float(l.split(", ")[0]))
        flux.append(float(l.split(", ")[1]))
    spline = UnivariateSpline(nsources, flux, k=1, s=0)
    return spline

theo_disc="""6.531875206118714, 1.195660628102472e-12
6.937524749227932, 1.1550966022093546e-12
7.368366376789494, 1.113399700228323e-12
7.825964594741677, 1.0740135364694893e-12
8.31198106965413, 1.0352435867779977e-12
8.828180662701957, 9.974988686525408e-13
9.37643783836815, 9.651048814050889e-13
9.95874347114617, 9.323626981477718e-13
10.577212074959684, 9.010693107225586e-13
11.234089481551509, 8.704996005618668e-13
11.931760995724115, 8.412825573361003e-13
12.672760057045725, 8.130461413435978e-13
13.459777439474864, 7.854627084240901e-13
14.295671022310025, 7.593846424823667e-13
15.183476167945312, 7.333465563323562e-13
16.126416744116625, 7.089987933525696e-13
17.127916830663263, 6.84945274539804e-13
18.191613153315416, 6.619560903051476e-13
19.321368289658096, 6.394985439444728e-13
20.521284695226097, 6.182666190933469e-13
21.795719600662554, 5.977396131777747e-13
23.149300834036886, 5.770275575493372e-13
24.58694362577736, 5.570331877474669e-13
26.11386845724166, 5.379334096908958e-13
27.735620017738597, 5.198784632286821e-13
29.458087338839167, 5.020526613151331e-13
31.287525179090267, 4.848380776695744e-13
33.230576736784926, 4.682137545941192e-13
35.29429777326543, 4.523291177511288e-13
37.48618223435774, 4.369833836745734e-13
39.8141894629759, 4.2184163306638874e-13
42.28677310171275, 4.0676648629016847e-13
44.91291179037053, 3.9488773092742753e-13
47.70214176990258, 3.8149075542641463e-13
50.66459151115999, 3.6951741470848186e-13
53.81101849419009, 3.579198652408194e-13
57.15284827164238, 3.464262832452121e-13
60.70221595813225, 3.355534642740009e-13
64.47201029622174, 3.2502189594714993e-13
68.47592045903322, 3.147027812918729e-13
72.72848575944951, 3.0459699345416753e-13
77.24514844640795, 2.9514772189021434e-13
82.04230978000732, 2.8577708187978207e-13
87.13738958905043, 2.766001608926201e-13
92.54888952729432, 2.6791888114496133e-13
98.29646025810752, 2.5951006912766905e-13
104.40097281150152, 2.5108242461187727e-13
110.8845943726532, 2.4329329318221846e-13
117.77086877712782, 2.35657371597691e-13
125.08480200510277, 2.28089903048536e-13
132.85295298504585, 2.2084828058980918e-13
141.10353003658093, 2.139970790921843e-13
149.86649330275276, 2.0712516944360527e-13
159.17366354364992, 2.0100109464608725e-13
169.058837686447, 1.9309224866972926e-13
179.55791155145926, 1.8570348321262343e-13
190.70901019986334, 1.786644678334245e-13
202.55262637641215, 1.718277881767607e-13
215.13176754986804, 1.6525271727361481e-13
228.49211208509954, 1.5892924454233758e-13
242.6821751139455, 1.529050958447221e-13
257.7534847071701, 1.4716449019772036e-13
273.76076898723846, 1.410560973342254e-13
283.68301457170065, 1.3937281831956907e-13"""

theo_sens = """4.575269352379525, 1.1920774787920212e-12
4.980671270482823, 1.1000614659709653e-12
5.448789118901897, 1.0169969130916907e-12
5.854126749082942, 9.626253034892773e-13
6.372844671485426, 9.093896351773201e-13
6.918551076987672, 8.605553802818094e-13
7.510986297698397, 8.135038058215824e-13
8.15415171998355, 7.694216167514648e-13
8.876668471061253, 7.275136749973877e-13
9.663205426019706, 6.87584239211513e-13
10.490665276446894, 6.503253865575346e-13
11.48293827404431, 6.08814208301945e-13
12.218351821166406, 5.889348099484227e-13
13.048424613868223, 5.615092634845653e-13
13.533703782169852, 5.476259483367221e-13
14.652410959153599, 5.198784632286821e-13
15.90709625726517, 4.912002301767485e-13
17.26922020159584, 4.645830450290159e-13
18.79939787085899, 4.3921394983025936e-13
20.546278235303426, 4.133644079051704e-13
21.881160227536867, 3.966269835240492e-13
23.420318831743863, 3.8524816802669417e-13
24.38576384031545, 3.7602020964144653e-13
26.473915712315087, 3.6063243404917237e-13
28.819695902042234, 3.4450073278766486e-13
31.373329163385673, 3.3001347870444675e-13
34.24689577940509, 3.1520495542052893e-13
37.38366000042515, 3.018384370507318e-13
40.58482114195271, 2.8844295194210236e-13
44.30209279467676, 2.7592647893285547e-13
48.35983923948656, 2.635449734744495e-13
52.78924546765416, 2.5236913797873474e-13
57.466753985635236, 2.4129352173675046e-13
62.55872355040644, 2.307039763199152e-13
68.28864333670157, 2.208068575616084e-13
74.54338170774486, 2.108987062209842e-13
83.66302239745636, 1.9996601234050856e-13
88.58106737374167, 1.922970415412117e-13
96.42998988630934, 1.832896080289982e-13
104.97438363708604, 1.7467834708782687e-13
114.27587240212513, 1.6652073606659768e-13
124.74270332851842, 1.5872069688501058e-13
135.4244154610333, 1.5136408191023415e-13
147.82829766416668, 1.441252293529195e-13
159.17366354364992, 1.3801995599367607e-13
175.18624342085613, 1.2979620249416585e-13
191.7564583992449, 1.2226869475651512e-13
200.345827959595, 1.201316754834909e-13"""

stefan_paper_disc="""1.0724872940578, 2.7521157009069386e-12
1.2398292462158491, 2.5419175477493017e-12
1.433281837732725, 2.357353781890398e-12
1.6569191545081947, 2.180515701513007e-12
1.9154509687494572, 2.0143236245790983e-12
2.214321926148685, 1.8656412080780366e-12
2.5598262093986106, 1.7346836402296289e-12
2.9592400928445963, 1.5920920796622481e-12
3.3985030437903245, 1.479182238113989e-12
3.954755550079344, 1.3728517573615794e-12
4.632483543908972, 1.2437333659787435e-12
5.355297551937666, 1.1414980779574912e-12
6.190893415584489, 1.0503932814631973e-12
7.138026304470964, 9.632991541279025e-13
8.230059234271122, 9.01988986931111e-13
9.564504811045126, 8.226969559617574e-13
11.056870189519337, 7.629625052958044e-13
12.78209178657127, 7.057284889708358e-13
14.776502540040696, 6.502477017925315e-13
17.082104475671198, 6.122741340416635e-13
19.747453264197272, 5.695179246245422e-13
22.82868079732506, 5.302296139606865e-13
26.3906773179211, 4.949364216711905e-13
30.508457999914047, 4.56620091071546e-13
35.36184225265387, 4.34447706944048e-13
40.771782557035905, 4.062156928527141e-13
47.13347068505412, 3.8214544359704044e-13
54.487783449524095, 3.5810253652815074e-13
63.82537605110178, 3.347011905496153e-13
74.7631555216096, 3.12017006253274e-13
86.4285733440866, 2.942924400790087e-13
99.91416544925062, 2.757768567940293e-13
115.50393661685081, 2.574205723098018e-13
132.5519796178593, 2.4629340070721367e-13
154.36051826143316, 2.2930280002011193e-13
178.44564319029286, 2.1571549739094233e-13
206.28880967908202, 2.031972196884486e-13
238.47639111834278, 1.9016563895313822e-13
275.68625370082594, 1.8147329269437854e-13
318.70203219353516, 1.6895432043328682e-13
368.4296331819058, 1.5935663193256208e-13
425.91631334225025, 1.4913666525230748e-13
492.3727345283555, 1.3975364356958256e-13
570.7009829191826, 1.320547951231697e-13
658.011429789727, 1.2256208388766284e-13
760.6820328014469, 1.144040951971833e-13
879.3724984562194, 1.0651190526077796e-13
1030.0709048838237, 9.890673926902365e-14
1190.7945582450518, 9.089462648078898e-14
1376.5961869449714, 8.320650051528365e-14
1591.3887486219614, 7.64662129295264e-14
1839.6957461148397, 6.918449854651685e-14
2004.2661174919015, 6.563712556046577e-14"""

stefan_paper_limit="""1.0724872940578, 2.123050226576288e-12
1.2398292462158491, 1.9222502167940326e-12
1.433281837732725, 1.7541807639948847e-12
1.6569191545081947, 1.6234337425069475e-12
1.9154509687494572, 1.4945121875134497e-12
2.2230954840861434, 1.3712469063887586e-12
2.5598262093986106, 1.236427213605631e-12
2.9592400928445963, 1.1450641198147534e-12
3.420975179856539, 1.066903265770182e-12
3.954755550079344, 9.497492035539021e-13
4.571822547259539, 8.928915519597585e-13
5.285171520452469, 8.226969559617574e-13
6.109825504348502, 7.54090316227643e-13
7.063151602389541, 6.797230791368428e-13
8.165226735662332, 6.116921349321816e-13
9.43926046019165, 5.837561741635065e-13
10.91208375710954, 5.37165655549042e-13
12.614714089556571, 4.69742114217841e-13
14.58300862633854, 4.451741105000796e-13
16.85841938914209, 4.043370874252486e-13
19.48886622660932, 3.835385993608344e-13
22.52974599998978, 3.4900509489212356e-13
26.045099233685153, 3.2653757826943223e-13
30.108958800193072, 3.040113165597073e-13
34.80690904257519, 2.845553464085928e-13
40.23788816936219, 2.64886983989904e-13
46.51627188009308, 2.4629340070721367e-13
53.77428210236601, 2.286481128327423e-13
62.16477156808326, 2.159960317844994e-13
71.86444287169648, 2.007647284895792e-13
83.07756980339164, 1.8442152069814409e-13
96.04029932799607, 1.7385479322832225e-13
111.02562480871373, 1.6291661587436895e-13
127.5060191173718, 1.617772620746348e-13
148.37566136488056, 1.4084767875752245e-13
171.5269592526135, 1.3147256262097454e-13
198.29059213488756, 1.2224392478584843e-13
229.23019856778137, 1.1373697011598891e-13
264.99736255605933, 1.0678911929959156e-13
306.34533582582503, 9.762962624094408e-14
354.1449012058918, 9.018860192545512e-14
409.40271119857545, 8.234587539123298e-14
473.2824879477771, 7.726538767477618e-14
546.4088240833647, 7.188475231746054e-14
632.4990495001124, 6.441179174574218e-14
731.1889139562177, 5.888707758703643e-14
845.2775198872106, 5.3976345284294523e-14
977.1675581906544, 4.8772864740336044e-14
1129.6366155670353, 4.4531616597192545e-14
1305.8956701269997, 3.966747600447909e-14
1509.6567141641501, 3.551880756138102e-14
1745.2109282200604, 3.196979782194229e-14
1952.11925200059, 2.802627319135663e-14"""

stefan_paper_sens="""1.0724872940578, 1.732430643176837e-12
1.452299265434182, 1.455535504909695e-12
1.9796223105486828, 1.155078390605127e-12
2.6984138777006845, 9.984799080787384e-13
3.6540334921775806, 8.176718113919988e-13
4.114273936116174, 7.573173483161003e-13
5.013730729382951, 6.970687357889898e-13
6.789299505654772, 5.792218445860117e-13
7.848645046955629, 5.215885216988455e-13
9.073282011169747, 4.885456564224435e-13
9.884934369088386, 4.653065756872918e-13
12.614714089556571, 4.009705158568221e-13
14.93314454459807, 3.490958227651612e-13
16.85841938914209, 3.3571770891366955e-13
18.366492854855334, 3.2316012047388764e-13
23.43850222378873, 2.8414473290135754e-13
25.36745953574603, 2.7613549998014024e-13
31.739042272188726, 2.3717613592965874e-13
43.54941242381025, 2.0372607251300014e-13
47.44513430661326, 2.001828485781726e-13
58.97205498248196, 1.8464078811725784e-13
65.9636505821974, 1.6684112401674326e-13
81.98969369207484, 1.5030415366570768e-13
88.73733556963258, 1.4721096858526836e-13
112.49876270610652, 1.2843265611087584e-13
128.34913521111855, 1.1692607753394532e-13
152.33921310356115, 1.1048796127569997e-13
164.8765261199059, 1.0595963417613464e-13
209.0259423353479, 9.340952217182511e-14
245.25055341118568, 8.444571166362095e-14
279.3441828394067, 8.019830571888895e-14
306.34533582582503, 7.626771416993363e-14
388.37622315297386, 6.576520715457383e-14
448.97520247355044, 5.938664207315691e-14
519.0295399643126, 5.43517768038852e-14
569.1984601494288, 5.259142759558332e-14
721.6142122137966, 4.4071015228059185e-14
781.002094501316, 4.244091200138035e-14
983.039784822283, 3.443697884901456e-14
1078.7056182235442, 3.39812757714091e-14
1323.2228808949585, 2.792798545671741e-14
1432.1223501136437, 2.6860051222190136e-14
1780.0602571119953, 2.198797668909911e-14
1978.0208477385715, 1.942570001349017e-14"""

stefan_wiki_disc = """1.0410522840875172, 3.811948405861831e-12
1.2164670955605836, 3.5637875960933487e-12
1.4379297177536787, 3.29918973275528e-12
1.6997104818904651, 3.059855482954261e-12
1.997595319106616, 2.8275124760001435e-12
2.3749230314503285, 2.6453494776759244e-12
2.791143069016737, 2.4613858856949872e-12
3.2803082578060008, 2.2933744201870574e-12
3.945173917757844, 2.120408401712451e-12
4.583415655032841, 2.004684174797734e-12
5.449181472209145, 1.8833034798647847e-12
6.404184428950864, 1.7717637753201632e-12
7.79156673650879, 1.6506819834128038e-12
8.94825634131209, 1.572394427031163e-12
10.638501138362592, 1.4812660097290434e-12
12.502964653525648, 1.3993114515805863e-12
15.211567465447672, 1.2970024869543149e-12
17.22522510914656, 1.2493363497433544e-12
20.769671013554817, 1.1666602822027464e-12
24.409685083494814, 1.0975641728544058e-12
29.50802229774349, 1.023200015333665e-12
33.521431793828775, 9.77733897608043e-13
40.548873229494596, 9.13821432382851e-13
47.655315550090194, 8.608856249785398e-13
57.2317020733599, 8.013883857227028e-13
65.44428592017795, 7.609988586240967e-13
79.16404256516968, 7.118423745466645e-13
93.03803356784319, 6.687606928220846e-13
110.61207773551371, 6.256756652581436e-13
129.24994737875258, 5.844847556269184e-13
152.7804089664763, 5.499551154878278e-13
181.63924821928327, 5.152338389092569e-13
213.47265659344666, 4.813897637044525e-13
253.79571321552757, 4.4605162441009293e-13"""

stefan_wiki_sens = """1.0715099607598098, 2.496532056945756e-12
1.2164670955605836, 2.3327450955240774e-12
1.3810344735687554, 2.1797035073320887e-12
1.5678650282820927, 2.029569059039778e-12
1.779970590131416, 1.889775628453873e-12
2.020770439152073, 1.7503748426768262e-12
2.2941464260088558, 1.6644848200914736e-12
2.6045055499612495, 1.5662368293739243e-12
2.9568510025666366, 1.4712048955980118e-12
3.3568628223922983, 1.3867961215578166e-12
3.810989460942794, 1.2980894497482247e-12
4.3265517359052055, 1.2322293032630804e-12
4.911860847506378, 1.1635709049877185e-12
5.576352360482829, 1.1006672333656608e-12
6.330738311540094, 1.0393393221749943e-12
7.187179894372984, 9.84014448052103e-13
8.15948350604195, 9.234986663929907e-13
9.26332331510103, 8.812695739021485e-13
10.516493939420824, 8.321662477333063e-13
11.939197307037826, 7.885607297356778e-13
13.554368324414176, 7.459304396650694e-13
15.388044602092636, 7.006708653693838e-13
17.469786197965558, 6.703928269002875e-13
19.83315214469318, 6.369380630854466e-13
22.516241443204137, 6.035625035155898e-13
25.562307243446327, 5.734427883390857e-13
29.02045411338257, 5.453042360467495e-13
32.94642963666213, 5.167302897422824e-13
37.40352310003908, 4.87938672841015e-13
42.46358575796484, 4.615602768906452e-13
48.20818912168599, 4.358426695955392e-13
54.72993994522302, 4.119191652455793e-13
62.13397310666212, 3.882857530362576e-13
70.53964645098021, 3.6761698783887377e-13
80.08246491637546, 3.474384068480683e-13
90.91626496227482, 3.2721737026085553e-13
103.21569451342341, 3.087142942946146e-13
117.17902839837237, 2.9074701457859637e-13
133.03136466907, 2.7286640023689977e-13
151.02825332831404, 2.572109885470159e-13
171.45981596251832, 2.409697084706742e-13
194.65542269096193, 2.2615034246122398e-13
220.98900182699424, 2.120562686789297e-13
249.44228692168292, 1.9760896430326071e-13"""

stefan_wiki_naive_exp = """1.1956007075025903, 2.1623973884726584e-12
1.3810344735687554, 1.869069724190413e-12
1.595228411305701, 1.615160664630122e-12
1.853301027065268, 1.3858201577846924e-12
2.14074196528691, 1.204456993887027e-12
2.48706658860256, 1.0374770454470944e-12
2.8728024961575516, 8.967440237972724e-13
3.3375582950698592, 7.718917269437964e-13
3.8552026894203295, 6.676451283004896e-13
4.4531320392121145, 5.765495099832797e-13
5.173550147075146, 4.970760947542689e-13
6.01051594442209, 4.2855754743997697e-13
6.9427273429106675, 3.7008379676957294e-13
8.019521685610297, 3.206178845253778e-13
9.316902627347678, 2.7597874756655095e-13
10.824171062874576, 2.379369606602106e-13
12.502964653525648, 2.051419396708907e-13
14.44213364878185, 1.7743682416919556e-13
16.778550917604015, 1.5273256692742194e-13
19.38084938251813, 1.3237892801593323e-13
22.516241443204137, 1.1402656949518819e-13
26.008436974929648, 9.851367431099013e-14
30.216025878417184, 8.479776633412995e-14
34.90243283604729, 7.33792462728389e-14
40.31568621156489, 6.333804200906936e-14
46.83787107426075, 5.451958343763873e-14
54.415200953215276, 4.700443093533596e-14
62.85482095400891, 4.061898115810661e-14
72.60339846134625, 3.5109045319233116e-14
84.34901985397022, 3.026950302731357e-14
97.43127743157166, 2.6139436053789958e-14
113.19349959697365, 2.254664982026657e-14
130.7494418047364, 1.9492690269583763e-14
151.90180482467082, 1.6778752861107513e-14
175.46127878962346, 1.448940661759481e-14
202.67475024424363, 1.2552732484674942e-14
230.0932084646741, 1.1051685838757098e-14"""

spline_stefan_wiki_naive = spline_data(stefan_wiki_naive_exp)
spline_stefan_wiki_sens = spline_data(stefan_wiki_sens)
spline_stefan_wiki_disc = spline_data(stefan_wiki_disc)
spline_stefan_paper_sens = spline_data(stefan_paper_sens)
spline_stefan_paper_limit = spline_data(stefan_paper_limit)
spline_stefan_paper_disc = spline_data(stefan_paper_disc)
spline_theo_sens = spline_data(theo_sens)
spline_theo_disc = spline_data(theo_disc)
